{% extends "__base.html" %}
{% block title %}Real World Django - Отправка писем{% endblock %}

{% block content %}


	<div class="vertical-layout">

		{% include "snippets/_left_menu.html" %}

	    <!-- Start MAIN_CONTAINER -->
	    <div class="rightbar">

		    {% with "События" as header %}
			    {% include "snippets/_top_bar.html" %}
		    {% endwith %}



	        <!-- Start CONTAINER_BAR -->
	        <div class="container mt-3">
	            <h2>Подписчики</h2>
	            <hr>
	            <div class="row">
	                <div class="col-lg-6">
	                    <form action="" method="post" class="mb-5">
	                        <label>Email:</label>
	                        <input type="email" class="form-control" required>
	                        <button type="submit" class="btn btn-primary mt-2">Добавить подписчика</button>
	                    </form>
	                </div>
	                <div class="col-lg-6">
	                    <form class="mb-5" id="formLetter">
	                        <label>Тема письма:</label>
	                        <input type="text" class="form-control" required>
	                        <label>Текст письма:</label>
	                        <textarea rows="3" class="form-control"></textarea>
	                        <button type="button" class="btn btn-primary mt-2" id="btnCreateLetters">Создать письма</button>
	                    </form>
	                </div>
	                <div class="col">
	                    <table class="table table-hover">
	                        <thead class="table-dark">
	                        <tr>
	                            <th scope="col">#</th>
	                            <th scope="col">Email</th>
	                            <th scope="col">Количество писем</th>
	                            <th scope="col">Отправленных</th>
	                        </tr>
	                        </thead>
	                        <tbody>
	                        <tr data-tr-email="user_1@mail.ru">
	                            <td data-td-name="counter">1</td>
	                            <td data-td-name="email">
	                                <span>user_1@mail.ru</span>
	                                <input type="hidden" name="email" value="user_1@mail.ru" form="formLetter">
	                            </td>
	                            <td data-td-name="letterCount">0</td>
	                            <td data-td-name="sentLetterCount">1</td>
	                        </tr>
	                        <tr data-tr-email="user_2@mail.ru">
	                            <td data-td-name="counter">1</td>
	                            <td data-td-name="email">
	                                <span>user_2@mail.ru</span>
	                                <input type="hidden" name="email" value="user_2@mail.ru" form="formLetter">
	                            </td>
	                            <td data-td-name="letterCount">1</td>
	                            <td data-td-name="sentLetterCount">1</td>
	                        </tr>
	                        </tbody>
	                    </table>
	                    <button type="button" class="btn btn-success my-2" id="btnSendLetters" form="formLetter">
	                        Отправить письма
	                    </button>
	                    <div class="alert alert-primary my-2 d-none" role="alert" id="alertSendingProcess">
	                        Выполняется отправка писем
	                    </div>
	                    <div class="alert alert-success my-2 d-none" role="alert" id="alertSendingDone">
	                        Отправка писем завершена
	                    </div>
	                </div>
	            </div>
	        </div>
	        <!-- End CONTAINER_BAR -->

	    </div>
	    <!-- End MAIN_CONTAINER -->

	    <script>
	        function readySubscribers() {

	            const urlCreateLetters = ""
	            const urlSendLetters = ""
	            const urlGetSubscribers = ""

	            let btnCreateLetters = document.getElementById('btnCreateLetters')
	            if (btnCreateLetters) {
	                btnCreateLetters.onclick = () => {
	                    createLetters(urlCreateLetters)
	                }
	            }

	            let btnSendLetters = document.getElementById('btnSendLetters')
	            if (btnSendLetters) {
	                btnSendLetters.onclick = () => {
	                    sendLetters(urlSendLetters, urlGetSubscribers)
	                }
	            }

	        }
	        document.addEventListener("DOMContentLoaded", readySubscribers)
	    </script>

			{% include "snippets/_footer.html" %}
	</div>

{% endblock %}